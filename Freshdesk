{
  "name": "Freshdesk",
  "version": "0.0.1",
  "type": "actuator",
  "script": "var subject = waylayUtil.template(options, options.requiredProperties.subject); \nvar message = waylayUtil.template(options, options.requiredProperties.message);\n\nvar apiKey = options.globalSettings.FRESHDESK_API_KEY;\nvar domain = options.globalSettings.FRESHDESK_DOMAIN || \"waylay\";\n\nconsole.log(message);\n\nif(apiKey && subject && message){\n\n  var url = \"https://\"+domain+\".freshdesk.com/api/v2/tickets\";\n  var data = {\n      \"unique_external_id\": \"waylayPlatform\",\n      \"subject\": subject,\n      \"description\": message,\n      \"status\": 2,\n      \"priority\": 2\n  }\n  var options = {\n    url: url,\n    json: data,\n    auth:{\n        user: apiKey,\n        pass: 'X'\n    }\n  };\n\n  var callback = function(error, response, body) {\n    if (!error && (response.statusCode == 200 || response.statusCode == 201)) {\n        console.log(response)\n      send();\n    }else{\n      console.log(response);\n      send(new Error(JSON.stringify(response)));\n    }\n  };\n\n  request.post(options, callback);\n}else{\n  send(new Error(\"Missing properties\"));\n}\n\n\n",
  "metadata": {
    "author": "Bruno",
    "category": "",
    "description": "Creates Freshdesk ticket.\nAn API key must be put in the global settings under key FRESHDESK_API_KEY.\nThe (Freshdesk) domain must be registerd in the global settings under key FRESHDESK_DOMAIN\n\nInput parameters are:\n<ul>\n<li>message</li>\n<li>subject</li>\n</ul>\n\nMessage will be parsed using waylayUtil.template function.\n",
    "iconURL": "https://developers.freshdesk.com/images/favicon.ico",
    "supportedStates": [],
    "requiredProperties": [
      "subject",
      "message"
    ],
    "requiredRawData": []
  }
}
